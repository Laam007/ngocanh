<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>üíñ 2 ƒë·ª©a m√¨nh üíñ</title>
<style>
html, body {
  height: 100%;
  margin: 0;
  background: radial-gradient(circle at center, #250016 0%, #000 100%);
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Tr√°i tim */
canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  z-index: 1;
  transform-origin: center;
  animation: heartbeat 1.5s infinite ease-in-out;
}
@keyframes heartbeat {
  0%, 50%, 100% { transform: scale(1); }
  25% { transform: scale(1.08); }
  75% { transform: scale(1.1); }
}

/* Album 3D */
.album-wrapper {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90vw;
  height: 90vw;
  max-width: 700px;
  max-height: 700px;
  perspective: 1800px;
  z-index: 3;
  display: flex;
  align-items: center;
  justify-content: center;
}

.album {
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: grab;
  touch-action: none;
  user-select: none;
}

.album:active { cursor: grabbing; }

.album img {
  position: absolute;
  width: 150px;
  height: 150px;
  object-fit: cover;
  border-radius: 20px;
  border: none;              /* ‚ùå b·ªè vi·ªÅn tr·∫Øng */
  box-shadow: none;          /* ‚ùå b·ªè ph√°t s√°ng */
  opacity: 0.85;
  transition: transform 0.6s ease, opacity 0.6s ease;
  backface-visibility: hidden;
}

.album img.front {
  opacity: 1;
  transform: scale(1.2);     /* nh·∫π h∆°n, kh√¥ng ch√≥i */
}

/* ·∫®n nh·∫°c (t·ª± ph√°t) */
audio { display: none; }
</style>
</head>
<body>

<!-- Tr√°i tim -->
<canvas id="pinkboard"></canvas>

<!-- Album ·∫£nh -->
<div class="album-wrapper">
  <div class="album">
    <img src="anh1.jpg" alt="">
    <img src="anh2.jpg" alt="">
    <img src="anh3.jpg" alt="">
    <img src="anh4.jpg" alt="">
    <img src="anh5.jpg" alt="">
    <img src="anh6.jpg" alt="">
    <img src="anh7.jpg" alt="">
    <img src="anh8.jpg" alt="">
    <img src="anh9.jpg" alt="">
    <img src="anh10.jpg" alt="">
    <img src="anh11.jpg" alt="">
    <img src="anh12.jpg" alt="">
    <img src="anh13.jpg" alt="">
    <img src="anh14.jpg" alt="">
    <img src="anh15.jpg" alt="">
    <img src="anh16.jpg" alt="">
    <img src="anh17.jpg" alt="">
    <img src="anh18.jpg" alt="">
  </div>
</div>

<!-- Nh·∫°c t·ª± ph√°t -->
<audio id="music" src="music.mp3" preload="auto" loop></audio>

<!-- Hi·ªáu ·ª©ng tr√°i tim bay -->
<script>
var settings = { particles: { length: 7000, duration: 4, velocity: 80, effect: -1.3, size: 8 } };
var Point = function(x, y) { this.x = x || 0; this.y = y || 0; };
Point.prototype.clone = function() { return new Point(this.x, this.y); };
Point.prototype.length = function(length) {
  if (length === undefined) return Math.sqrt(this.x*this.x + this.y*this.y);
  this.normalize(); this.x *= length; this.y *= length; return this;
};
Point.prototype.normalize = function() {
  var l = this.length(); this.x /= l; this.y /= l; return this;
};
var Particle = function() { this.position = new Point(); this.velocity = new Point(); this.acceleration = new Point(); this.age = 0; };
Particle.prototype.initialize = function(x, y, dx, dy) {
  this.position.x = x; this.position.y = y; this.velocity.x = dx; this.velocity.y = dy;
  this.acceleration.x = dx * settings.particles.effect; this.acceleration.y = dy * settings.particles.effect; this.age = 0;
};
Particle.prototype.update = function(dt) {
  this.position.x += this.velocity.x * dt; this.position.y += this.velocity.y * dt;
  this.velocity.x += this.acceleration.x * dt; this.velocity.y += this.acceleration.y * dt; this.age += dt;
};
Particle.prototype.draw = function(ctx, img) {
  function ease(t){return (--t)*t*t+1;}
  var size = img.width * ease(this.age / settings.particles.duration);
  ctx.globalAlpha = 1 - this.age / settings.particles.duration;
  ctx.drawImage(img, this.position.x - size/2, this.position.y - size/2, size, size);
};
var ParticlePool = function(length) {
  this.particles = new Array(length);
  for (var i=0;i<length;i++) this.particles[i] = new Particle();
  this.firstActive = 0; this.firstFree = 0; this.duration = settings.particles.duration;
};
ParticlePool.prototype.add = function(x, y, dx, dy) {
  var p = this.particles[this.firstFree];
  p.initialize(x, y, dx, dy);
  this.firstFree = (this.firstFree + 1) % this.particles.length;
  if (this.firstFree === this.firstActive) this.firstActive = (this.firstActive + 1) % this.particles.length;
};
ParticlePool.prototype.update = function(dt) {
  for (var i=0;i<this.particles.length;i++) this.particles[i].update(dt);
};
ParticlePool.prototype.draw = function(ctx, img) {
  for (var i=0;i<this.particles.length;i++) this.particles[i].draw(ctx, img);
};
(function(canvas) {
  var ctx = canvas.getContext('2d'),
      particles = new ParticlePool(settings.particles.length),
      particleRate = settings.particles.length / settings.particles.duration,
      time;
  function pointOnHeart(t){
    return new Point(160*Math.pow(Math.sin(t),3),
      130*Math.cos(t)-50*Math.cos(2*t)-20*Math.cos(3*t)-10*Math.cos(4*t)+25);
  }
  var image = (function(){
    var c=document.createElement('canvas'),ctx=c.getContext('2d');
    c.width=settings.particles.size;c.height=settings.particles.size;
    function to(t){var p=pointOnHeart(t);
      p.x=settings.particles.size/2+p.x*settings.particles.size/350;
      p.y=settings.particles.size/2-p.y*settings.particles.size/350;
      return p;}
    ctx.beginPath();var t=-Math.PI,p=to(t);ctx.moveTo(p.x,p.y);
    while(t<Math.PI){t+=0.01;p=to(t);ctx.lineTo(p.x,p.y);}
    ctx.closePath();ctx.fillStyle='#ff1744';ctx.fill();
    var img=new Image();img.src=c.toDataURL();return img;
  })();
  function render(){
    requestAnimationFrame(render);
    var newTime=new Date().getTime()/1000,dt=newTime-(time||newTime);time=newTime;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(var i=0;i<particleRate*dt;i++){
      var pos=pointOnHeart(Math.PI-2*Math.PI*Math.random());
      var dir=pos.clone().length(settings.particles.velocity);
      particles.add(canvas.width/2+pos.x,canvas.height/2-pos.y,dir.x,-dir.y);
    }
    particles.update(dt);particles.draw(ctx,image);
  }
  function onResize(){canvas.width=canvas.clientWidth;canvas.height=canvas.clientHeight;}
  window.onresize=onResize;
  setTimeout(()=>{onResize();render();},10);
})(document.getElementById('pinkboard'));
</script>

<script>
const album = document.querySelector('.album');
const imgs = document.querySelectorAll('.album img');
const music = document.getElementById('music');

let angle = 0;
const total = imgs.length;
const deg = 360 / total;
const radius = 600; // ‚úÖ tƒÉng kho·∫£ng c√°ch gi·ªØa c√°c ·∫£nh

// S·∫Øp x·∫øp ·∫£nh quanh v√≤ng tr√≤n
imgs.forEach((img, i) => {
  const rotateY = deg * i;
  img.style.transform = `rotateY(${rotateY}deg) translateZ(${radius}px)`;
});

function updateFront() {
  let closest = Math.round((-angle / deg) % total);
  imgs.forEach((img, i) => {
    img.classList.remove('front');
    if ((i + total) % total === (closest + total) % total)
      img.classList.add('front');
  });
}

// T·ª± ph√°t nh·∫°c
window.addEventListener('load', () => {
  music.volume = 0.7;
  music.play().catch(() => {
    document.addEventListener('click', () => music.play(), { once: true });
  });
});

// T·ª± xoay m∆∞·ª£t
let autoSpeed = 0.08;
let autoRotate = true;
function animate() {
  if (autoRotate) {
    angle -= autoSpeed;
    album.style.transform = `rotateY(${angle}deg)`;
    updateFront();
  }
  requestAnimationFrame(animate);
}
animate();

// K√©o tay xoay th·ªß c√¥ng
let startX = 0, currentAngle = 0, dragging = false;
function startDrag(x) {
  dragging = true;
  startX = x;
  currentAngle = angle;
  album.style.transition = 'none';
  autoRotate = false;
  document.body.style.overflow = 'hidden';
}
function moveDrag(x) {
  if (!dragging) return;
  const dx = x - startX;
  angle = currentAngle + dx * 0.4;
  album.style.transform = `rotateY(${angle}deg)`;
  updateFront();
}
function endDrag() {
  dragging = false;
  autoRotate = true;
  document.body.style.overflow = '';
}
album.addEventListener('mousedown', e => startDrag(e.clientX));
window.addEventListener('mousemove', e => moveDrag(e.clientX));
window.addEventListener('mouseup', endDrag);
album.addEventListener('touchstart', e => startDrag(e.touches[0].clientX));
album.addEventListener('touchmove', e => moveDrag(e.touches[0].clientX));
album.addEventListener('touchend', endDrag);
</script>
</body>
</html>
